class RemoteSwitch{constructor(a,b){this._state=!1,this._time="00:00",this.onStateChangeCallback=a,this.onTimeChangeCallback=b,this._d("constructor()","done")}connectRequest(){webusb.requestPort().then(a=>{this._connect(a)}).catch(a=>{console.error("Connection error (1): "+a),this._state=!this._state,this.onStateChangeCallback(this.state)})}_connect(a){this._port=a,this._d("device.productName",this._port.device_.productName),this._port.connect().then(()=>{this._d("port",this._port),this._port.onReceive=b=>{this._proceed(b)},this._port.onReceiveError=b=>{console.log("Receive error: "+b)},this._sendState()},b=>{console.log("Connection error (2): "+b),this._state=!this._state,this.onStateChangeCallback(this.state)})}get state(){return this._state}set state(a){this._d("state",a);this._state==a||(this._state=a,this._port==void 0?this.connectRequest():this._sendState())}get time(){return void 0!=this._port&&this._state?this._time:"00:00"}_proceed(a){this._d("data",a),a.startsWith("LOW")?(this._state=!1,this._d("state",this.state),this.onStateChangeCallback(this.state)):a.startsWith("HIGH")?(this._state=!0,this._d("state",this.state),this.onStateChangeCallback(this.state)):a.startsWith("T")&&(this._time=a.substring(1),this._d("time",this._time),this.onTimeChangeCallback(this.time))}_sendState(){this._port.send(this._state?"H":"L")}_d(a,b){console.log(a+"="+b)}}